# Automatic Whisper Transcriber
This repository combines some scripts to allow running via Docker the Whisper transcription automatically for files.

## Overview

This project provides a set of bash scripts to automate the transcription of audio files using the OpenAI Whisper model. The scripts are designed to handle large volumes of audio files by breaking them into smaller parts, transcribing each part individually, and then concatenating the results.

## Scripts

### 1. `concat_files.sh`

This script is responsible for collecting all transcription parts generated by `process_whisper.sh` and combining them into a single file.

#### Usage:
```bash
./concat_files.sh <document_name>
```

#### Arguments:
- `<document_name>`: The base name of the audio files to be processed (e.g., "meeting").

#### Steps:
1. **Argument Check**: Ensure a document name is provided.
2. **Directory Setup**: Determine the current directory and set the output file path.
3. **File Collection**: List all part files matching the pattern `<document_name>.wav-part*.txt`.
4. **Output File Initialization**: Clear or create the final output file.
5. **Concatenation**: Append each collected part file to the final output file, adding newlines between parts.
6. **Completion Message**: Confirm completion and display the path to the final concatenated file.

### 2. `process_whisper.sh`

This script handles the transcription of individual audio parts using Docker containers for isolation.

#### Usage:
```bash
./process_whisper.sh <MODELS_DIR> <AUDIOS_DIR> <AUDIO_DIR> <AUDIO_FILE> <MODEL_FILE> <OFFSET_DURATION_MINUTES> <AUDIO_DURATION_MINUTES>
```

#### Arguments:
- `<MODELS_DIR>`: Directory containing the Whisper model files.
- `<AUDIOS_DIR>`: Base directory for audio files.
- `<AUDIO_DIR>`: Subdirectory within `AUDIOS_DIR` containing the audio files to be transcribed.
- `<AUDIO_FILE>`: Specific audio file (without extension) to be transcribed.
- `<MODEL_FILE>`: Model file to be used for transcription.
- `<OFFSET_DURATION_MINUTES>`: Duration of each transcription part in minutes.
- `<AUDIO_DURATION_MINUTES>`: Total duration of the audio file in minutes.

#### Steps:
1. **Argument Check**: Ensure all required arguments are provided.
2. **Conversion to Milliseconds**: Convert offset and duration from minutes to milliseconds.
3. **Iteration Setup**: Initialize iteration parameters and total duration in milliseconds.
4. **Docker Command Construction**: Build the Docker command for each part, including optional offset and duration limits.
5. **Execution Loop**: Run the Docker container with the constructed command for each iteration until all parts are processed.
6. **Output File Renaming**: Rename the output file to include the iteration number after each transcription.
7. **Completion Check**: Stop the loop if the total offset exceeds the audio duration.

## Usage Example

### For `concat_files.sh`:
```bash
./concat_files.sh meeting
```

### For `process_whisper.sh`:
```bash
./process_whisper.sh /models /audios/meeting meeting meeting model.bin 10 60
```

## Notes

- Ensure Docker is installed and properly configured to run containers with the required volume mounts.
- Adjust the script paths and parameters according to your project structure and requirements.
- The scripts assume that audio files are named in a specific pattern (`<document_name>.wav`) and transcription parts will be saved as `<document_name>.wav-part*.txt`.

## Conclusion

These scripts provide a robust framework for automating the transcription of large sets of audio files using Whisper. By breaking down the process into manageable parts, they ensure scalability and ease of use. Adjustments may be necessary based on specific project requirements and infrastructure configurations.